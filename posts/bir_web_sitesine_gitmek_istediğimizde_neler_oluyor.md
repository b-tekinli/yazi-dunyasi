Bir web sitesine gitmek istediÄŸimizde neler oluyor?
===================================================

### Modern web nasÄ±lÂ Ã§alÄ±ÅŸÄ±r?

![](https://cdn-images-1.medium.com/max/800/0*o1e_2SYlsTvRzYpO.png)

Herkese merhaba, browserâ€™a girdim ve URLâ€™e `beyza.com` yazdÄ±m. Fakat baÅŸÄ±na da `http` ya da `https` eklemeden enterâ€™a bastÄ±m. Bu durumda arka planda neler oluyor adÄ±m adÄ±m en ince detaylara kadar size aktarmaya Ã§alÄ±ÅŸacaÄŸÄ±m.

Ã–ncelikle bilgisayarÄ± ilk aÃ§tÄ±ÄŸÄ±mÄ±zda internete ihtiyacÄ±mÄ±z var ve iÅŸletim sistemimizin aÄŸ baÄŸdaÅŸtÄ±rÄ±cÄ±sÄ± (bu ethernet ya da wifi olabilir) local aÄŸÄ±mÄ±zda 1 adet duyuru mesajÄ± Ã§Ä±kÄ±yor **_â€œIP adresi istiyorumâ€_** ÅŸeklinde. Bu mesaja da DHCP Discover mesajÄ± diyoruz. Tabii bu mesajÄ± gÃ¶nderebilmek iÃ§in bir IP adresine ihtiyacÄ±mÄ±z var Ã§Ã¼nkÃ¼ internet alt yapÄ±sÄ± IP adresleriyle Ã§alÄ±ÅŸÄ±r. Fakat zaten amacÄ±mÄ±z bir IP adresi istemekti. O zaman nasÄ±l mesajÄ± atÄ±yor? Ä°ÅŸte bu yÃ¼zden en baÅŸta IP adresimiz `0.0.0.0` olarak belirleniyor. Bunun dÄ±ÅŸÄ±nda bir de iletiÅŸim protokolÃ¼ kullanarak mesajÄ± atmasÄ± gerektiÄŸi iÃ§in UDP Ã¼zerinden broadcast olarak yani local aÄŸdaki tÃ¼m cihazlara iletilecek ÅŸekilde gÃ¶nderiyor. Buradan da hedef IP adresinin `255.255.255.255` olarak belirlendiÄŸini anlÄ±yoruz tÃ¼m cihazlara iletileceÄŸi iÃ§in. Fakat bu mesaj DHCPâ€™ye Ã¶zel bir formatta oluÅŸturulup atÄ±ldÄ±ÄŸÄ± iÃ§in sadece DHCP cevap veriyor. MesajÄ±n iÃ§erisindeki veri bilgisayarÄ±mÄ±zÄ±n MAC adresi. Zaten ARP tablosunda tutup bilgisayarÄ±mÄ±zÄ± tanÄ±mak iÃ§in MAC adresine ihtiyacÄ± var. KÄ±saca mesajÄ± Ã¶zetleyecek olursak ÅŸÃ¶yle gÃ¶rÃ¼ndÃ¼ÄŸÃ¼nÃ¼ sÃ¶yleyebiliriz:  
\- **Kaynak IP adresi:** `0.0.0.0` _(Benim IP adresim yok)_  
\- **Hedef IP adresi:** `255.255.255.255` _(Local aÄŸdaki tÃ¼m cihazlara gÃ¶nderiyorum)_  
\- **MAC adresi:** BilgisayarÄ±n kimliÄŸi _(mesela 00:1A:2B:3C:4D:5E olabilir)_

Peki bu mesajÄ± alan DHCP sunucusu nasÄ±l yanÄ±t verecek? Bilmemiz gereken ÅŸey bu DHCP sunucusunun modemimizin iÃ§inde olmasÄ± ve **_â€œBu bilgisayara bir IP adresi saÄŸlayabilirimâ€_** ÅŸeklinde yanÄ±t vermesi. Bu yanÄ±ta da DHCP Offer diyoruz. Åimdi biraz da bu mesajÄ±n ne olduÄŸuna ve ne iÃ§erdiÄŸine bakalÄ±m. YanÄ±t olarak verilen bu mesaj bilgisayarÄ±mÄ±za geÃ§ici olarak bir IP adresi verir. Fakat sadece IP vermekle kalmayÄ±p bilgisayarÄ±mÄ±zÄ±n internete Ã§Ä±kabilmesi iÃ§in gerekli olan tÃ¼m ayarlarÄ± saÄŸlayacaktÄ±r. Mesela hangi DNS ile iletiÅŸimde olacaÄŸÄ±, subnet mask, gateway gibi. Ã–rneklendirirsek daha iyi olacaktÄ±r. Diyelim ki DHCP Offer yanÄ±tÄ± geldi ve bize Ã¶nerdiÄŸi IP adresi `192.168.1.12` bunun Ã¼zerinden devam edelim.  
\- **Ã–nerilen IP adresi:** `192.168.1.12`  
\- **Gateway:** `192.168.1.1` _(yani modemin IP adresi)_  
\- **DNS sunucusu:** `192.168.1.1` _(ya da kullandÄ±ÄŸÄ±mÄ±z ISPâ€™nin DNS sunucusu)  
_\- **Subnet Mask:** `255.255.255.0` _(bu arada bu C sÄ±nÄ±fÄ± bir IP adresi olduÄŸunu belirtiyor yani aÄŸÄ±n yapÄ±sÄ±nÄ± belirtiyor eÄŸer Ã§ok daha detaylÄ± bilgi almak isterseniz buradaki_ [**_Network_**](/post/1) _adlÄ± yazÄ±mÄ± da okuyabilirsiniz)_

Bu mesaj bilgisayarÄ±mÄ±za yanÄ±t olarak geldi IP adresinin geÃ§ici olarak bilgisayara atanabileceÄŸini belirtti tamam ama bilgisayarÄ±mÄ±z daha bu adresi kabul etmedi. BilgisayarÄ±mÄ±z bu mesaja DHCP Request adÄ± verilen mesajla **_â€Bu IP adresini kullanmayÄ± kabul ediyorumâ€_** ÅŸeklinde karÅŸÄ±lÄ±k vererek onay vermiÅŸ oluyor. Hatta bu mesaj da broadcast olarak gÃ¶nderiliyor ama yine sadece DHCP sunucusu iÅŸleyebiliyor ona Ã¶zel formatta olduÄŸundan. Peki ÅŸimdi artÄ±k bilgisayarÄ±mÄ±z bu IP adresini aldÄ± mÄ±? HayÄ±r.. DHCP sunucusu da DHCP Request mesajÄ±nÄ± aldÄ±ktan sonra **_â€œTamam bu IP adresini senin iÃ§in ayÄ±rÄ±yorumâ€_** diyerek son kez DHCP Acknowledgement (ACK) adÄ± verilen bir mesaj daha gÃ¶nderiyor. Bu mesajla artÄ±k geÃ§ici IP adresinin verilme iÅŸleminin tamamlandÄ±ÄŸÄ±nÄ± bildirmiÅŸ olur ve adÄ± Ã¼stÃ¼nde geÃ§ici olduÄŸu iÃ§in ne kadar sÃ¼reyle verileceÄŸini de sÃ¶yler. Bu sÃ¼re lease time yani kira sÃ¼resi olarak adlandÄ±rÄ±lÄ±r. ArtÄ±k bilgisayarÄ±mÄ±z internete Ã§Ä±kabilmek iÃ§in gerekli tÃ¼m aÄŸ bilgilerine sahip diyebiliriz.

![](https://cdn-images-1.medium.com/max/800/1*RmydOcmN5QTvaq2F9NmWmQ.png)

Bundan sonraki kÄ±sÄ±mda tarayÄ±cÄ±mÄ±zÄ± aÃ§Ä±p URL kÄ±smÄ±na `beyza.com` yazdÄ±ÄŸÄ±mÄ±zÄ± dÃ¼ÅŸÃ¼nelim. Browser, yazdÄ±ÄŸÄ±m bu ifadeyi analiz edip URL olarak algÄ±layacaktÄ±r. Fakat doÄŸru bir ÅŸekilde anlaÅŸÄ±lmasÄ± iÃ§in http ya da https gibi protokollere ihtiyacÄ± var. Protokol belirtmediÄŸimiz iÃ§in otomatik olarak http ya da https eklemeye karar verecek ve en gÃ¼venli olan protokolÃ¼ seÃ§mek isteyecektir. Peki bu sÃ¼reÃ§ nasÄ±l iÅŸliyor yani tarayÄ±cÄ± nasÄ±l karar veriyor? BazÄ± siteler, Chrome gibi tarayÄ±cÄ±lara **_â€œHSTS (HTTP Strict Transport Security)â€_** adÄ±nda gÃ¼venlik politikasÄ± uyguluyor. Bunu TÃ¼rkÃ§eâ€™ye HTTP SÄ±kÄ± AktarÄ±m GÃ¼venliÄŸi olarak Ã§evirebiliriz. Bu politika da tarayÄ±cÄ±ya kullanÄ±cÄ±larÄ±n mutlaka https kullanarak baÄŸlanmasÄ±nÄ± sÃ¶yler. Chrome da kendi iÃ§indeki HSTS listesine Ã¶nceden yÃ¼klenmiÅŸ popÃ¼ler siteler iÃ§in bu politikayÄ± zorlar. EÄŸer `beyza.com` sitesi bu HSTS listesinde bulunuyorsa, tarayÄ±cÄ± http Ã¼zerinden baÄŸlantÄ±yÄ± kabul etmez ve sadece https Ã¼zerinden baÄŸlanmaya zorlanÄ±r. Mesela google ya da banka web siteleri gibi HSTS listesinde olan bir siteye http Ã¼zerinden baÄŸlanmaya Ã§alÄ±ÅŸÄ±rsak chrome bunu otomatik olarak deÄŸiÅŸtirip https Ã¼zerinden baÄŸlanÄ±r. Åimdi de browser, HSTS listesini nasÄ±l sorguluyor diye bir soru Ã§Ä±kageldi deÄŸil mi? ÅÃ¶yle ki, bu liste tarayÄ±cÄ±nÄ±n hafÄ±zasÄ±nda ya da veri dosyalarÄ±nda saklanÄ±yor diyebiliriz. Tabii bu liste Ã¶zel bir veri yapÄ±sÄ±yla saklanÄ±yor ve hÄ±zlÄ± bir ÅŸekilde sonuÃ§ almak iÃ§in de hash tablosu ya da search tree gibi verimli bir algoritmayla sorgulanÄ±yor. DolayÄ±sÄ±yla tÃ¼m listeyi kontrol etmiyor. Chrome geliÅŸtiricileri ve gÃ¼venlik ekipleri tarafÄ±ndan bu liste dÃ¼zenli olarak gÃ¼ncelleniyor. Bunlar dÄ±ÅŸÄ±nda eÄŸer sadece `beyza` yazsaydÄ±k Ã¶nce DNS Ã§Ã¶zÃ¼mleme yaparak bunun gerÃ§ek bir web adresi olup olmadÄ±ÄŸÄ±nÄ± kontrol edecekti. Fakat biz tam bir domain adÄ± yazdÄ±ÄŸÄ±mÄ±z iÃ§in bunu URL olarak iÅŸledi o yÃ¼zden DNS Ã¼zerinden siteye direkt olarak baÄŸlanmaya Ã§alÄ±ÅŸacak.

![](https://cdn-images-1.medium.com/max/800/1*9SEmqE6sCwIB1QLbX6Mw8g.png)

Åimdi gelelim DNS kÄ±smÄ±na. TarayÄ±cÄ±, ilk olarak baÄŸlantÄ± kurmak iÃ§in `https://beyza.com` haline getirmiÅŸ olduÄŸu URLâ€™i kullanmayÄ± dener. Tam bu noktada belirttiÄŸimiz siteye gitmek iÃ§in bir IP adresine ihtiyaÃ§ duyar. Fakat domain olarak belirttiÄŸimiz adresler insan tarafÄ±ndan daha anlaÅŸÄ±lÄ±r olduÄŸu iÃ§in bunu IP adresine Ã§evirmek zorunda. Zaten yazÄ±nÄ±n en baÅŸÄ±nda da belirtmiÅŸtik internet alt yapÄ±sÄ±nÄ±n IP adresleriyle Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ±. Ä°ÅŸte burada da DNS kavramÄ±nÄ±n kilidi aÃ§Ä±lÄ±yor bizim iÃ§in. DNS sorgu yaparak bu sitenin IP adresini isteyecek ama bir sÃ¼rÃ¼ evreden geÃ§iyor. TarayÄ±cÄ± Ã¶nce bilgisayarÄ±mÄ±zÄ±n Ã¶nbelliÄŸini kontrol eder. Mesela ben Ubuntu kullandÄ±ÄŸÄ±m iÃ§in `/etc/hosts` dosyasÄ±na bakar. EÄŸer burada `beyza.com` adresine ulaÅŸmak iÃ§in yapÄ±lan bir DNS sorgusunun sonucu varsa onu kullanacak ama ilk defa bu adrese gideceÄŸimiz iÃ§in orada bulamayacak. Peki bulamadÄ±ÄŸÄ±nda ne oluyor? BilgisayarÄ±mÄ±z sorguyu modemimize iletiyor. Bu iletim, eÄŸer ethernet kablosuyla baÄŸlÄ±ysanÄ±z onunla deÄŸilseniz kablosuz baÄŸlantÄ± Ã¼zerinden iletiliyor. Modem de kendi DNS Ã¶nbelleÄŸinde domain adresini arÄ±yor. Daha Ã¶nce sorgulamadÄ±ÄŸÄ±mÄ±z iÃ§in orada da bulamÄ±yor ve ISPâ€™mizin yani kullandÄ±ÄŸÄ±mÄ±z internet servis saÄŸlayÄ±cÄ±mÄ±zÄ±n (TÃ¼rknet, TÃ¼rk Telekom vs.) DNS sorgularÄ±na yÃ¶nlendirecek. Sorgu, modemi terkedip aÄŸdan Ã§Ä±kÄ±yor ve tam bu noktada sokaÄŸa adÄ±m atmÄ±ÅŸ oluyor.

![](https://cdn-images-1.medium.com/max/800/1*lVNj3ngpourw9AlH1FOe5A.png)

Ä°steÄŸimiz modemdeki kablo Ã¼zerinden dÄ±ÅŸarÄ± Ã§Ä±kÄ±p sokaktaki daÄŸÄ±tÄ±cÄ± kutuya gidiyor. SokaÄŸÄ±mÄ±zdaki tÃ¼m ISPâ€™lerden gelen sorgular oradan daÄŸÄ±tÄ±lÄ±yor yani diÄŸer kullanÄ±cÄ±larÄ±n da baÄŸlÄ± olduÄŸu bir baÄŸlantÄ± noktasÄ± diyebiliriz. Bu kutudan Ã§Ä±kan hatlar ISPâ€™mizin bÃ¶lgesel santraline yÃ¶nlendiriliyor. Bu santral de ISPâ€™mizin ana baÄŸlantÄ± merkezi (backbone aÄŸÄ±) fakat buraya gelene kadar sokaktan Ã§Ä±kÄ±p cadde oradan Ã§Ä±kÄ±p semt oradan da ilÃ§e gibi daha birÃ§ok yerden geÃ§iyor. En son ana merkeze geldiÄŸinde burada sinyal fiber optik kablolar Ã¼zerinden gittiÄŸi iÃ§in Ä±ÅŸÄ±k hÄ±zÄ±nda uzak mesafelere hÄ±zlÄ±ca eriÅŸim saÄŸlayabiliyor. ArtÄ±k sinyal ISPâ€™mizin kendi DNS sunucusuna (Recursive DNS) geldiÄŸinde burada da yine ISP DNSâ€˜inin Ã¶nbelleÄŸinde domain sorgulanÄ±yor. EÄŸer bulamazsa bir Ã¼st dÃ¼zey DNS sunucularÄ±na yÃ¶nlendirilmek Ã¼zere recursive DNS sorgulama sÃ¼reci baÅŸlÄ±yor. Recursive DNS, adÄ± Ã¼stÃ¼nde tekrarlayÄ±cÄ± ve bizim yerimize sorgulanmasÄ± gereken tÃ¼m DNSâ€™lerle muhatap olarak tÃ¼m iÅŸi kendisi yapÄ±yor. Bu noktada DNS zincirleme sorgu tamlamasÄ± baÅŸlÄ±yor diyebiliriz ğŸ˜… Bu sÃ¼reÃ§ baÅŸlamadan Ã¶nce BGP (Border Gateway Protocol) protokolÃ¼nden de bahsetmemiz gerekiyor.

![](https://cdn-images-1.medium.com/max/800/0*PtnIEq-vaMpvkBKG.png)

Recursive DNS, Authoritative DNSâ€™e ulaÅŸana kadar birÃ§ok farklÄ± aÄŸ Ã¼zerinden geÃ§mesi gerekiyor ve buradaki yÃ¶nlendirme haritasÄ± BGPâ€™dir diyebiliriz. Ä°nternette, dÃ¼nya Ã§apÄ±ndaki aÄŸlar AS (Autonomous System) adÄ± verilen ISPâ€™ler, ÅŸirket ya da Ã¼niversiteler gibi kurumlarÄ±n sahip olduÄŸu farklÄ± farklÄ± aÄŸlardan oluÅŸuyor. Her AS kendi IP bloklarÄ±na sahip ve o bloklar aracÄ±lÄ±ÄŸÄ±yla ASâ€™lerle baÄŸlantÄ± kuruyor. BGP de bu noktada ASâ€™lerin birbiriyle nasÄ±l baÄŸlantÄ± kuracaÄŸÄ±nÄ± ve hangi yollar Ã¼zerinden gideceÄŸini belirleyen protokol oluyor. KÄ±saca harita gÃ¶revi gÃ¶rÃ¼yor ve paketlerin hangi ASâ€™lerden geÃ§eceÄŸini belirliyor. AynÄ±, arabayla giderken yolumuzu kaybettiÄŸimizde navigasyona sarÄ±larak bize en verimli gÃ¼zergahÄ± bulmasÄ±nÄ± istediÄŸimizdeki gibi en verimli ve hÄ±zlÄ± yolu belirliyor. Birazdan anlatacaÄŸÄ±m tÃ¼m sÃ¼reÃ§te yolu BGPâ€™nin belirlediÄŸini bilelim.

DNS kÄ±smÄ±na geri dÃ¶nelim. Ã–ncelikle Recursive DNS aradÄ±ÄŸÄ± IP adresinin nerde olduÄŸunu bilemeyebilir. Bu yÃ¼zden Ã¶nce Root DNS adÄ± verilen en Ã¼st dÃ¼zey DNS sunucusuna sorgu gÃ¶nderir. Bu arada dÃ¼nyada yaklaÅŸÄ±k 13 tane root sunucu var bonus bilgi olsun Ã§ok daha detaylÄ± bilgi edinmek isterseniz [burayÄ±](https://www-recordedfuture-com.translate.goog/threat-intelligence-101/cyber-threat-landscape/dns-root-servers?_x_tr_sl=en&_x_tr_tl=tr&_x_tr_hl=tr&_x_tr_pto=tc&_x_tr_hist=true) okuyabilirsiniz.

![](https://cdn-images-1.medium.com/max/800/0*dXNxedVK2l2mJLYy)

YukarÄ±daki resimde de gÃ¶rdÃ¼ÄŸÃ¼nÃ¼z gibi Root DNS en Ã¼stte bulunur. Root DNS, tÃ¼m domainlerin Ã¼st dÃ¼zey bilgi daÄŸÄ±tÄ±mÄ±nÄ± yapar. Recursive DNS, Root DNSâ€™e gidip **_â€œbeyza.comâ€™un IP adresini nerede bulabilirim?â€_** diye sorar. Root DNS ise **_â€œBen com uzantÄ±lÄ± domainlerin ayrÄ±ntÄ±larÄ±nÄ± falan bilmem amaÂ .com alan adlarÄ± iÃ§in bilgileri tutan TLD (Top Level Domain) DNSâ€™e yÃ¶nlendirebilirimâ€_** diyerek TLD DNSâ€™in IP adresini Recursive DNSâ€™e verir. ArdÄ±ndan Recursive DNS gidip TLD DNSâ€™inÂ `.com` iÃ§in Ã¶zel sunucusuna sorgu gÃ¶nderir. TLD DNSâ€™e ÅŸÃ¶yle bir gÃ¶z atalÄ±m Ã¶nce.

![](https://cdn-images-1.medium.com/max/800/1*H8XxIw4AfI4dRU6sup2orQ.png)

Buraya bakarak sadeceÂ `.com` iÃ§in Ã¶zel olarak attÄ±ÄŸÄ±mÄ±zÄ± daha net anlayabiliriz. Recursive DNS, TLD DNSâ€™e **_â€œbeyza.comâ€™un IP adresi nerede bulunabilir?â€_** diye sorar. TLD DNS de **_â€œbeyza.com domaininin authoritative DNSâ€™ine gitmelisinâ€_** diyerek Recursive DNSâ€™imize onun IP adresini vererek yÃ¶nlendirir. Authoritative (yetkili) DNS, domain hakkÄ±nda en doÄŸru bilgiyi saÄŸlayan sunucudur diyebiliriz Ã§Ã¼nkÃ¼ direkt olarak domain sahibinin kontrolÃ¼nde olan sunucu burasÄ±dÄ±r. KÄ±saca sorgu yaptÄ±ÄŸÄ±mÄ±z son kale diyebiliriz. KafanÄ±z karÄ±ÅŸtÄ±ysa bile merak etmeyin Ã§izdiÄŸim yolu vericem o zaman Ã§ok daha iyi oturacak her ÅŸey. Recursive DNS, Auth DNSâ€™e gidip **_â€œbeyza.comâ€™un IP adresi nedir?â€_** diye sorar. Ã–nceden domain yÃ¶neticileri gerekli bilgileri Auth DNSâ€™e saÄŸlamÄ±ÅŸtÄ±r. Mesela IP adresi ya da diÄŸer DNS kayÄ±tlarÄ±nÄ± auth dns zaten kendinde tutar. Bu yÃ¼zden auth dns, ilgili domain hakkÄ±nda kesin bilgilere sahip olduÄŸundan Recursive DNSâ€™e **_â€œbeyza.comâ€™un IP adresi_** `12.1.1.12` diyerek direkt olarak cevabÄ± verir.

> UnutmayalÄ±m ki Recursive DNS aslÄ±nda bizim ISPâ€™mizin DNSâ€™i olduÄŸu iÃ§in bizle aynÄ± ISPâ€™yi kullanarak Ã¶nceden `"beyza.comâ€` sorgusu yapmÄ±ÅŸ olan kullanÄ±cÄ±lar varsa direkt olarak kendi Ã¶nbelleÄŸinde bulup bize verebilirdi yani Ã§ok daha hÄ±zlÄ± cevap alabilirdik. FarklÄ± bakÄ±ÅŸ aÃ§Ä±larÄ± kazandÄ±rmak iÃ§in bunu da tekrar hatÄ±rlatmak istedim.

Bu arada evimizde oturup yaptÄ±ÄŸÄ±mÄ±z istek dÃ¼nyayÄ± dolaÅŸtÄ± ama biz hala istediÄŸimiz sayfayÄ± gÃ¶rÃ¼ntÃ¼leyemedik sÃ¶yleyeceklerim bu kadar.. Åaka, daha Ã§ok yolumuz var.

![](https://cdn-images-1.medium.com/max/800/1*UCFZazVT4_FHo4rFclelzA.png)

En son Recursive DNS bu IP adresini kendi Ã¶nbelleÄŸine aldÄ± bir de bunu bize geri iletmesi gerekecek. ISPâ€™den sonra mahalle, sokak, evdeki modem kablosu derken artÄ±k domainin bu IP adresine denk geldiÄŸi bilgisi tarayÄ±cÄ±mÄ±za ulaÅŸacak. TarayÄ±cÄ±, `beyza.com` sunucusuna baÄŸlanmak iÃ§in IP adresini Ã¶ÄŸrendikten sonra veri alÄ±ÅŸveriÅŸi iÃ§in baÄŸlantÄ± kurmak zorunda. Bu da TCP adÄ± verilen protokolle yapÄ±lÄ±yor. TCP baÄŸlantÄ±sÄ±nÄ±n gerÃ§ekleÅŸmesi iÃ§in 3'lÃ¼ el sÄ±kÄ±ÅŸma (three-way handshake) adÄ± verilen bir iÅŸlem gerÃ§ekleÅŸtiriliyor. Bu iÅŸlemde TCPâ€™nin gÃ¶nderdiÄŸi 3 flag var.

![](https://cdn-images-1.medium.com/max/800/1*gMlKFPeuhax08P8aGQmBNw.png)

Bilgisayar Ã¶nce sunucuya SYN adlÄ± paket gÃ¶nderir ve bu paket **_â€œben seninle senkronize olmak istiyorumâ€_** anlamÄ±na gelen ve baÄŸlantÄ± kurmak istediÄŸini sÃ¶yleyen bir mesajdÄ±r. Sunucu da bu mesajÄ± aldÄ±ktan sonra SYN-ACK paketi gÃ¶nderir. Bu da **_â€œbenimle senkronize olmak istediÄŸin mesajÄ±nÄ± aldÄ±m ben de seninle senkronize olmak istiyorumâ€_** anlamÄ±na gelen bir mesajdÄ±r. Bilgisayar da bu paketi aldÄ±ktan sonra tekrar sunucuya ACK paketi gÃ¶nderir ve **_â€œben de benimle senkronize olmak istediÄŸini anladÄ±mâ€_** anlamÄ±na gelen bilgi mesajÄ±nÄ± gÃ¶nderir ve bÃ¶ylece baÄŸlantÄ± kurulmuÅŸ olur. Bundan sonraki kÄ±sÄ±mda tarayÄ±cÄ± en baÅŸta https baÄŸlantÄ±sÄ± kurmayÄ± seÃ§tiÄŸi iÃ§in verilerin ÅŸifreli olarak gÃ¶nderilmesini saÄŸlayacak. Yani TLS protokolÃ¼ devreye girecek. Bu da 2 cihaz arasÄ±nda gÃ¼venli baÄŸlantÄ± kurmak iÃ§in anlaÅŸmadÄ±r diyebiliriz. Peki TLS baÄŸlantÄ±sÄ± hangi aÅŸamalardan geÃ§erek kuruluyor? TLSâ€™in de TCP gibi el sÄ±kÄ±ÅŸma sÃ¼reci var fakat bu 2 aÅŸamadan oluÅŸuyor. Bu aÅŸamalarda amaÃ§, tarayÄ±cÄ± ve sunucunun birbirlerine hangi ÅŸifreleme algoritmalarÄ±nÄ± kullanacaklarÄ±nÄ± sÃ¶ylemek ve tarayÄ±cÄ±nÄ±n gerÃ§ekten `beyza.com` sunucusuna baÄŸlandÄ±ÄŸÄ±ndan emin olmaktÄ±r.

![](https://cdn-images-1.medium.com/max/800/1*CLbmMotKOVaP5Ex7-SvgJg.png)

YukarÄ±daki Ã§izimimde gÃ¶rÃ¼ldÃ¼ÄŸÃ¼ Ã¼zere tarayÄ±cÄ± sunucuya **_â€œmerhabaâ€_** anlamÄ±na gelen bir Client Hello mesajÄ± gÃ¶nderir. Bu mesajÄ±n iÃ§eriÄŸinde tahmin edeceÄŸiniz Ã¼zere sadece merhaba yazmÄ±yor tabii ki ğŸ˜„ Mesaj iÃ§eriÄŸinde;

*   DesteklediÄŸi ÅŸifreleme algoritmalarÄ± **_(mesela AES, RSA gibi)_**
*   TLS protokol versiyonu **_(mesela TLS 1.2 ya da TLS 1.3 gibi sÃ¼rÃ¼mler olabilir)_**
*   BaÄŸlantÄ±yÄ± benzersiz bir hale getirmek iÃ§in random bir sayÄ±

Bu mesajÄ± gÃ¶ndermek yani iÃ§inde bunlarÄ± bulundurma amacÄ± da gÃ¼venli baÄŸlantÄ± kurarken uyum saÄŸlamaya Ã§alÄ±ÅŸmasÄ±ndan kaynaklanÄ±yor. **_â€œBen bu algoritmalarÄ± ve bu sÃ¼rÃ¼mleri kullanÄ±yorum haberin olsun sen de ona gÃ¶re kullan ki uyumlu Ã§alÄ±ÅŸabilelimâ€_** demek istiyor. TarayÄ±cÄ± bu bilgileri gÃ¶nderdikten sonra sunucu bu isteÄŸi alÄ±yor ve desteklediÄŸi Ã¶zellikleri tarayÄ±cÄ±nÄ±nkilerle karÅŸÄ±laÅŸtÄ±rÄ±yor. Ona karÅŸÄ±lÄ±k olarak **_â€œsana da merhabaâ€_** anlamÄ±na gelen bir Server Hello mesajÄ± gÃ¶nderiyor. Åimdi de Server Hello mesajÄ±nda neler var ona bakalÄ±m;

*   Sunucu, tarayÄ±cÄ±nÄ±n ona Ã¶nerdiÄŸi ÅŸifreleme algoritmalarÄ±ndan birini seÃ§er. Ã–rnek olarak RSA ve AES yazmÄ±ÅŸtÄ±m burada da atÄ±yorum RSA seÃ§ti bunu gÃ¶nderir.
*   TarayÄ±cÄ±nÄ±n gÃ¶nderdiÄŸi random sayÄ±ya kendi random sayÄ±sÄ±nÄ± da birleÅŸtirerek daha gÃ¼venli bir anahtar oluÅŸmasÄ±nÄ± saÄŸlar ve onu gÃ¶nderir.

BÃ¶ylece Server Hello mesajÄ± da tarayÄ±cÄ±ya ulaÅŸÄ±r. ArdÄ±ndan sunucu kim olduÄŸunu kanÄ±tlamak iÃ§in bir SSL/TLS sertifikasÄ± gÃ¶nderir. Bu sertifikaya, kim olduÄŸunu ve gerÃ§ekten `beyza.com`â€™a ait olduÄŸunu kanÄ±tlayan belgedir diyebiliriz. AyrÄ±ca bu sertifikada public key bulunur. Ã‡Ã¼nkÃ¼ bu anahtar, daha sonra ÅŸifreleme anahtarÄ±nÄ±n gÃ¼venli bir ÅŸekilde paylaÅŸÄ±lmasÄ±nÄ± saÄŸlayacak. TarayÄ±cÄ±, sunucunun gÃ¶nderdiÄŸi sertifikayÄ± doÄŸrulayÄ±p kimliÄŸinin geÃ§erli olup olmadÄ±ÄŸÄ±nÄ± kontrol eder. NasÄ±l mÄ±? ÅÃ¶yle, sertifika CA (Sertifika Otoritesi) tarafÄ±ndan yani gÃ¼venilir bir sertifika otoritesi tarafÄ±ndan imzalanmÄ±ÅŸ olmalÄ±dÄ±r. EÄŸer tarayÄ±cÄ± bunu kontrol ettiÄŸinde sertifika doÄŸrulanmazsa tarayÄ±cÄ±, kullanÄ±cÄ±ya bir uyarÄ± gÃ¶sterir. Bu uyarÄ±yÄ± hepimiz en az 1 kez gÃ¶rmÃ¼ÅŸÃ¼zdÃ¼r **_â€œBu site gÃ¼venli deÄŸilâ€_** ÅŸeklinde. Sertifika doÄŸrulanÄ±rsa tarayÄ±cÄ±, sunucunun kimliÄŸine gÃ¼venir.

![](https://cdn-images-1.medium.com/max/800/0*OUOuv9vUtWPHpwMx.png)

Bundan sonraki aÅŸamada tarayÄ±cÄ± ve sunucu gÃ¼venli baÄŸlantÄ± iÃ§in anahtar paylaÅŸÄ±mÄ± yapacak fakat bu anahtar aradaki iletiÅŸimin gÃ¼venli olmasÄ± iÃ§in korunmalÄ±. TarayÄ±cÄ±, baÄŸlantÄ±yÄ± ÅŸifrelemek iÃ§in Pre-Master Secret adÄ± verilen Ã¶zel bir anahtar oluÅŸturur. Bu da tarayÄ±cÄ±yla sunucu arasÄ±nda daha sonra tÃ¼retilecek olan ÅŸifreleme temelini oluÅŸturacak. TarayÄ±cÄ±nÄ±n, bu anahtarÄ± nasÄ±l gÃ¶ndereceÄŸine gelirsek, sunucunun sertifikasÄ±nda bulunan public key ile ÅŸifreleyip sunucuya gÃ¶nderir. BÃ¶ylelikle, sadece sunucu kendi Ã¶zel anahtarÄ±yla bu mesajÄ± Ã§Ã¶zebilir ve pre-master secretâ€™Ä± Ã§Ã¶zebilir. Bu aÅŸamadan sonra da artÄ±k aralarÄ±nda gÃ¼venli baÄŸlantÄ± temeli iÃ§in Master Secret adÄ± verilen anahtarÄ± Ã¼retirler. Bu, hem tarayÄ±cÄ± hem de sunucunun bildiÄŸi random sayÄ±lar ve pre-master secret kullanarak hesaplanÄ±yor. Åimdi de aklÄ±mÄ±zda **_â€œMaster Secret ne iÅŸe yarar?â€_** diye bir soru belirmiÅŸ olabilir. Master secret, artÄ±k 2 taraf arasÄ±nda gÃ¶nderilecek verilerin ÅŸifrelenmesinde ve kullanÄ±lacak simetrik ÅŸifreleme anahtarlarÄ±nÄ±n Ã¼retilmesinde gÃ¶rev alacak. Bu arada ÅŸifreleme algoritmalarÄ± simetrik ve asimetrik olarak 2 farklÄ± baÅŸlÄ±kta incelenebilir. Ben burada ikisi arasÄ±ndaki farktan bahsedicem Ã¶nce. Simetrik, iletiÅŸimin yoÄŸun olduÄŸu ve bÃ¼yÃ¼k veri paketlerinin iletilmesi gerektiÄŸinde kullanÄ±lÄ±rken, asimetrik ÅŸifreleme de veri aktarÄ±mÄ±ndan Ã¶nce gÃ¼venli iletiÅŸim kanalÄ±nÄ± oluÅŸtururken kimlik doÄŸrulayarak gÃ¼venli bir iletiÅŸim hattÄ± kurmak iÃ§in kullanÄ±lÄ±r. Åimdi master secretâ€™Ä±n neden simetrik olduÄŸuna gelecek olursak, veri aktarÄ±mÄ± sÄ±rasÄ±nda daha hÄ±zlÄ±dÄ±r ve aynÄ± anahtar, veri ÅŸifreleme ve Ã§Ã¶zme iÅŸlemleri iÃ§in kullanÄ±lÄ±r. Bu yÃ¼zden veri transferi boyunca bu anahtar kullanÄ±lacaktÄ±r. Buradan sonraki kÄ±sÄ±mda da artÄ±k kendi taraflarÄ±nda anahtarlarÄ±n ve ayarlarÄ±n baÅŸarÄ±lÄ± bir ÅŸekilde tamamlandÄ±ÄŸÄ±nÄ± doÄŸrulamak iÃ§in birbirlerine **_â€œgÃ¶revimiz tamamlandÄ± daÄŸÄ±labilirizâ€_** anlamÄ±na gelen Finished mesajÄ± gÃ¶nderirler. Bu mesaj geldiÄŸinde artÄ±k anlarlar ki TLS handshake sÃ¼reci baÅŸarÄ±lÄ± bir ÅŸekilde bitti ve 2 tarafta da ayarlar uyumlu. Bu mesajdan sonra tÃ¼m baÄŸlantÄ± tamamen ÅŸifreli haldedir ve eÄŸer bir veri iletecekse en son oluÅŸturulan simetrik anahtarlarla ÅŸifrelenmiÅŸ olarak iletilecektir. Buradan sonraki kÄ±sÄ±mda web sayfasÄ±nÄ±n iÃ§eriÄŸini almak iÃ§in bir HTTP GET isteÄŸi yapÄ±lÄ±r. Bu istek de **_â€œana sayfayÄ± bana gÃ¶nderâ€_** anlamÄ±na gelir. Ä°lk olarak tarayÄ±cÄ± sayfayÄ± yÃ¼klemek iÃ§in HTTP GET isteÄŸi oluÅŸturur. Bu isteÄŸin iÃ§inde sunucuya bazÄ± bilgiler gÃ¶nderilir mesela tarayÄ±cÄ±nÄ±n IP adresi, User-Agent bilgisi, istenilen sayfanÄ±n yolu gibi.

![](https://cdn-images-1.medium.com/max/800/1*e5ZpCjCeOqtZZ01csj2JNg.png)

Bu ÅŸekilde headerâ€™lar dÃ¼ÅŸÃ¼nebiliriz. Bu headerâ€™lar paketin nereye gitmesi gerektiÄŸini ve kimden geldiÄŸini belirten Ã¶zelliklere sahiptir. Daha detaylÄ± bilgi iÃ§in [buradaki](/post/2) yazÄ±ma gidebilirsiniz. Paketler oluÅŸturulduktan sonra tarayÄ±cÄ± bu paketleri bilgisayarÄ±mÄ±zÄ±n NIC yani aÄŸ arayÃ¼z kartÄ±na gÃ¶nderir. Paketler artÄ±k modemden geÃ§ip internete doÄŸru gider ve yine ISPâ€™ye kadar olan yol gerÃ§ekleÅŸir. ArtÄ±k ISPâ€™de DNS Ã§Ã¶zÃ¼mlemesinden sonra belirlenen `beyza.com IP: 12.1.1.12` adresi olduÄŸu iÃ§in direkt sunucuya ulaÅŸmaya gider. TarayÄ±cÄ±dan gelen paketler IP adresine ulaÅŸtÄ±ÄŸÄ±nda, sunucu bu paketleri alÄ±p birleÅŸtirir. BÃ¶ylece orijinal GET isteÄŸi yeniden oluÅŸturulur. Sunucu bu isteÄŸi okur ve ana sayfa iÃ§eriÄŸini hazÄ±rlar. Bu aÅŸamada da HTML, CSS, JS gibi iÃ§erikleri tarayÄ±cÄ±ya geri gÃ¶ndermek Ã¼zere hazÄ±rlÄ±yor. HazÄ±rladÄ±ktan sonra yine TCP ile iletileceÄŸi iÃ§in sayfa iÃ§eriÄŸini paketlere bÃ¶lÃ¼p gÃ¶nderir. TarayÄ±cÄ± da yeniden paketleri birleÅŸtirip ÅŸifreyi Ã§Ã¶zer ve sayfa iÃ§eriÄŸine ulaÅŸÄ±r. Son olarak HTMLâ€™i render edip ana sayfayÄ± kullanÄ±cÄ±ya gÃ¶sterir.

Bir isteÄŸin serÃ¼veninin sonuna geldik umarÄ±m herkes iÃ§in faydalÄ± olmuÅŸtur. KolaylÄ±klar ğŸ’«
